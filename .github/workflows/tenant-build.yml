name: Tenant Build
on:
  workflow_dispatch:
    inputs:
      tenant:
        description: 'Tenant to build'
        required: true
        default: 'dev'
  push:
    branches: [steble_design]
    paths: ['.github/workflows/tenant-build.yml']

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    - name: Get tenant
      run: |
        TENANT="${{ github.event.inputs.tenant || 'dev' }}"
        echo "Building for: $TENANT"

        # Check if env file exists
        if [ -f "env/.env.${TENANT}" ]; then
          echo "✅ Found env/.env.${TENANT}"
          echo "📋 Configuration preview:"
          head -5 "env/.env.${TENANT}"
        else
          echo "❌ No env file for $TENANT"
          echo "Available:"
          ls env/.env.* | head -3
          exit 1
        fi

    - name: Check secrets directory
      run: |
        if [ -d ".secrets" ]; then
          echo "🔐 Secrets directory exists"
          ls .secrets/ | head -3
        else
          echo "⚠️ No .secrets directory"
        fi