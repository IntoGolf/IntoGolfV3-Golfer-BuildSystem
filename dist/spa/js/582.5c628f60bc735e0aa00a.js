"use strict";(globalThis["webpackChunkintogolf_app_golfer"]=globalThis["webpackChunkintogolf_app_golfer"]||[]).push([[582],{1344:(e,o,n)=>{n.r(o),n.d(o,{default:()=>z});var t=n(2852),a=n(3100);const l={class:"row items-center justify-between q-mb-md"},s={key:0,class:"text-center q-pa-md"},i={key:1},r={key:0,class:"text-orange q-ml-sm"},g={key:1,class:"text-blue q-ml-sm"},c={key:2,class:"text-green q-ml-sm"},u={key:0,class:"text-positive q-ml-sm"},p={key:2,class:"text-center q-pa-md text-grey-6"};function k(e,o,n,k,b,d){const m=(0,t.g2)("q-btn"),v=(0,t.g2)("q-spinner"),f=(0,t.g2)("q-tooltip"),y=(0,t.g2)("q-icon"),_=(0,t.g2)("q-item-label"),h=(0,t.g2)("q-item-section"),x=(0,t.g2)("q-item"),q=(0,t.g2)("q-list"),j=(0,t.g2)("q-page"),F=(0,t.gN)("ripple");return(0,t.uX)(),(0,t.Wv)(j,{class:"q-pa-md"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",l,[o[0]||(o[0]=(0,t.Lk)("div",{class:"text-h5 text-weight-bold"}," Open Bookings ",-1)),(0,t.bF)(m,{loading:k.loading,dense:"",flat:"",icon:"refresh",round:"",onClick:k.loadOpenBookings},null,8,["loading","onClick"])]),o[7]||(o[7]=(0,t.Lk)("div",{class:"text-body2 text-grey-6 q-mb-md"}," Starttijden die open staan voor andere spelers om bij aan te sluiten ",-1)),k.loading?((0,t.uX)(),(0,t.CE)("div",s,[(0,t.bF)(v,{color:"primary",size:"2em"})])):k.openBookings.length>0?((0,t.uX)(),(0,t.CE)("div",i,[(0,t.bF)(q,{separator:""},{default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(k.openBookings,(n,l)=>(0,t.bo)(((0,t.uX)(),(0,t.Wv)(x,{key:l,class:(0,a.C4)(["full-width shadow-1 q-mb-sm",k.isMyBooking(n)?"bg-orange-1 text-orange-8":k.isAlreadyOnFlight(n)?"bg-blue-1 text-blue-8":"bg-white"]),clickable:!k.cannotJoin(n),onClick:e=>!k.cannotJoin(n)&&k.handleJoinFlight(n)},{default:(0,t.k6)(()=>[(0,t.bF)(h,null,{default:(0,t.k6)(()=>[(0,t.bF)(_,{class:"itg-text-overflow"},{default:(0,t.k6)(()=>[o[2]||(o[2]=(0,t.Lk)("i",{class:"far fa-calendar-alt mr-2"},null,-1)),(0,t.eW)(" "+(0,a.v_)(e.$filters.unixToDate(n.fltDate,"dddd DD-MM"))+" - "+(0,a.v_)(e.$filters.minuteToTime(n.fltTime1))+" ",1),(0,t.bF)(y,{class:"q-ml-sm",color:"green",name:"lock_open",size:"sm"},{default:(0,t.k6)(()=>[(0,t.bF)(f,{class:"bg-green"},{default:(0,t.k6)(()=>o[1]||(o[1]=[(0,t.eW)(" Open voor aansluiting ",-1)])),_:1,__:[1]})]),_:1})]),_:2,__:[2]},1024),(0,t.bF)(_,{caption:""},{default:(0,t.k6)(()=>[o[3]||(o[3]=(0,t.Lk)("i",{class:"far fa-golf-club mr-2"},null,-1)),(0,t.eW)(" "+(0,a.v_)(n.loop1.crlName)+" ",1),k.isMyBooking(n)?((0,t.uX)(),(0,t.CE)("span",r," • Mijn boeking ")):k.isAlreadyOnFlight(n)?((0,t.uX)(),(0,t.CE)("span",g," • U staat al op deze starttijd ")):((0,t.uX)(),(0,t.CE)("span",c," • Geboekt door: "+(0,a.v_)(n.booker_name),1))]),_:2,__:[3]},1024),(0,t.bF)(_,{caption:"",class:"q-mt-xs"},{default:(0,t.k6)(()=>[o[4]||(o[4]=(0,t.Lk)("i",{class:"far fa-users mr-2"},null,-1)),(0,t.eW)(" "+(0,a.v_)(n.current_players)+" van "+(0,a.v_)(n.fltSize)+" spelers ",1),n.available_spots>0?((0,t.uX)(),(0,t.CE)("span",u," • "+(0,a.v_)(n.available_spots)+" plekken vrij ",1)):(0,t.Q3)("",!0)]),_:2,__:[4]},1024)]),_:2},1024),(0,t.bF)(h,{avatar:""},{default:(0,t.k6)(()=>[k.cannotJoin(n)?k.isMyBooking(n)?((0,t.uX)(),(0,t.Wv)(y,{key:1,color:"orange",name:"person",size:"24px"})):k.isAlreadyOnFlight(n)?((0,t.uX)(),(0,t.Wv)(y,{key:2,color:"blue",name:"check_circle",size:"24px"})):(0,t.Q3)("",!0):((0,t.uX)(),(0,t.Wv)(y,{key:0,color:"grey-5",name:"chevron_right",size:"24px"}))]),_:2},1024)]),_:2},1032,["class","clickable","onClick"])),[[F,!k.cannotJoin(n)]])),128))]),_:1})])):((0,t.uX)(),(0,t.CE)("div",p,[(0,t.bF)(y,{class:"q-mb-md",name:"lock_open",size:"4em"}),o[5]||(o[5]=(0,t.Lk)("div",null,"Geen open bookings beschikbaar",-1)),o[6]||(o[6]=(0,t.Lk)("div",{class:"text-caption q-mb-md"},"Er zijn momenteel geen starttijden open voor aansluiting",-1))]))]),_:1,__:[7]})}n(9552),n(5118);var b=n(5124),d=n(4004);const m={name:"OpenBookings",setup(){const e=(0,d.A)(),{proxy:o}=(0,t.nI)(),n=(0,b.KR)(!1),a=(0,b.KR)([]),l=(0,b.KR)([]),s=o.$store.getters["currentUser/item"],i=async()=>{try{const e=await o.$axios.get("golfer/bookings");l.value=e||[]}catch(e){console.error("Error loading user bookings:",e)}},r=async()=>{n.value=!0;try{const[e]=await Promise.all([o.$axios.get("golfer/open-bookings"),i()]);a.value=e||[],a.value.length>0&&(console.log("Open booking sample:",a.value[0]),console.log("Available fields:",Object.keys(a.value[0]))),l.value.length>0&&(console.log("User bookings sample:",l.value[0]),console.log("User bookings count:",l.value.length)),console.log("Current user:",s)}catch(t){console.error("Error loading open bookings:",t),e.notify({type:"negative",message:"Fout bij laden van open bookings"})}finally{n.value=!1}},g=e=>{if(!s)return!1;if(l.value&&l.value.length>0){const o=l.value.some(o=>{if(e.fltNr&&o.fltNr)return e.fltNr===o.fltNr&&o.flight_players[0].flpRelNr===s.relNr});return o}return!1},c=e=>!!s&&l.value.some(o=>o.fltNr===e.fltNr),u=e=>g(e)||c(e),p=o=>{g(o)?e.notify({type:"warning",message:"Dit is uw eigen boeking - u kunt zich niet aansluiten bij uw eigen starttijd"}):c(o)?e.notify({type:"info",message:"U staat al op deze starttijd"}):o.available_spots<=0?e.notify({type:"negative",message:"Deze starttijd is vol"}):e.dialog({title:"Aansluiten bij starttijd",message:`Wilt u aansluiten bij de open booking van ${o.booker_name}?`,persistent:!0,ok:{label:"Ja, aansluiten",color:"primary"},cancel:{label:"Annuleren",color:"grey"}}).onOk(async()=>{await k(o)})},k=async t=>{n.value=!0;try{const n={fltNr:t.fltNr};await o.$axios.post("golfer/booking/join",n),e.notify({type:"positive",message:"Succesvol aangesloten bij open booking",timeout:2e3}),await r()}catch(a){console.error("Error joining open booking:",a),e.notify({type:"negative",message:"Fout bij aansluiten bij open booking",timeout:2e3})}finally{n.value=!1}};return(0,t.sV)(()=>{r()}),(0,t.wB)(()=>o.$store.state.currentUser.item,()=>{o.$store.state.currentUser.item&&r()},{deep:!0}),{loading:n,openBookings:a,userBookings:l,loadOpenBookings:r,handleJoinFlight:p,isMyBooking:g,isAlreadyOnFlight:c,cannotJoin:u}}};var v=n(6317),f=n(2507),y=n(3178),_=n(2977),h=n(192),x=n(9091),q=n(3656),j=n(4701),F=n(8219),A=n(5497),w=n(4850),C=n(1082),B=n.n(C);const X=(0,v.A)(m,[["render",k],["__scopeId","data-v-08b3d255"]]),z=X;B()(m,"components",{QPage:f.A,QBtn:y.A,QSpinner:_.A,QList:h.A,QItem:x.A,QItemSection:q.A,QItemLabel:j.A,QIcon:F.A,QTooltip:A.A}),B()(m,"directives",{Ripple:w.A})}}]);