"use strict";(globalThis["webpackChunkintogolf_app_golfer"]=globalThis["webpackChunkintogolf_app_golfer"]||[]).push([[55],{9055:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Fe});var a=s(2852);function l(e,t,s,l,n,o){const r=(0,a.g2)("chat-messages"),i=(0,a.g2)("chat-form"),c=(0,a.g2)("chat-list");return null===e.$store.state.chats.chat||e.$store.state.chats.edit?null!==e.$store.state.chats.chat&&e.$store.state.chats.edit?((0,a.uX)(),(0,a.Wv)(i,{key:1})):((0,a.uX)(),(0,a.Wv)(c,{key:2,onHandleNew:o.handleNew},null,8,["onHandleNew"])):((0,a.uX)(),(0,a.Wv)(r,{key:0}))}const n={class:"row q-mb-sm",style:{"font-size":"24px","font-weight":"bold"}},o={class:"col-3 justify-end text-right"};function r(e,t,s,l,r,i){const c=(0,a.g2)("q-btn"),h=(0,a.g2)("chat-list-item"),m=(0,a.g2)("q-list"),d=(0,a.g2)("q-pull-to-refresh"),u=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(u,{class:"q-pa-sm"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{onRefresh:i.onRefresh},{default:(0,a.k6)(()=>[(0,a.Lk)("div",n,[t[1]||(t[1]=(0,a.Lk)("div",{class:"col-9"},"Chats",-1)),(0,a.Lk)("div",o,[(0,a.bF)(c,{color:"primary",flat:"",icon:"add",round:"",size:"small",onClick:t[0]||(t[0]=t=>e.$emit("handleNew"))})])]),(0,a.bF)(m,{bordered:"",separator:""},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.$store.state.chats.chats,(e,t)=>((0,a.uX)(),(0,a.Wv)(h,{key:t,item:e},null,8,["item"]))),128))]),_:1})]),_:1},8,["onRefresh"])]),_:1})}var i=s(3100);const c={class:"row",style:{height:"24px"}},h={class:"col-6"},m={class:"col-6 text-right"},d={class:"row"};function u(e,t,s,l,n,o){const r=(0,a.g2)("q-avatar"),u=(0,a.g2)("q-item-section"),g=(0,a.g2)("q-item"),p=(0,a.gN)("ripple");return(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:"",onClick:t[0]||(t[0]=t=>e.$store.dispatch("chats/set",{chat:s.item,edit:!1}))},{default:(0,a.k6)(()=>[(0,a.bF)(u,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,{color:"blue",icon:"group","text-color":"white"})]),_:1}),(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",c,[(0,a.Lk)("div",h,[(0,a.Lk)("b",null,(0,i.v_)(s.item.chtName),1)]),(0,a.Lk)("div",m,(0,i.v_)(s.item.lastMessageTime),1)]),(0,a.Lk)("div",d,(0,i.v_)(s.item.lastMessageText),1)]),_:1})]),_:1})),[[p]])}const g={props:{item:Object}};var p=s(6317),f=s(9091),k=s(3656),b=s(2287),v=s(4850),C=s(1082),w=s.n(C);const _=(0,p.A)(g,[["render",u]]),y=_;w()(g,"components",{QItem:f.A,QItemSection:k.A,QAvatar:b.A}),w()(g,"directives",{Ripple:v.A});const L={components:{ChatListItem:y},mounted(){this.fetchChats()},methods:{async onRefresh(e){await this.fetchChats(),e()},async fetchChats(){await this.$store.dispatch("chats/fetchChats")}}};var A=s(2507),N=s(573),F=s(3178),$=s(192);const q=(0,p.A)(L,[["render",r]]),M=q;w()(L,"components",{QPage:A.A,QPullToRefresh:N.A,QBtn:F.A,QList:$.A});var Q=s(9006);const X={class:"q-pl-sm"},I={ref:"scrollContainer",style:{height:"Calc(100vh - 160px)","overflow-y":"scroll"}},T={class:"column col justify-end q-pa-sm"};function x(e,t,s,l,n,o){const r=(0,a.g2)("q-btn"),c=(0,a.g2)("q-avatar"),h=(0,a.g2)("q-banner"),m=(0,a.g2)("chat-message"),d=(0,a.g2)("q-input"),u=(0,a.g2)("q-toolbar"),g=(0,a.g2)("q-footer"),p=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(p,{class:"flex column bg-grey-4"},{default:(0,a.k6)(()=>[(0,a.bF)(h,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{flat:"",icon:"arrow_back_ios",round:"",onClick:t[0]||(t[0]=t=>e.$store.dispatch("chats/close"))}),(0,a.bF)(c,{color:"blue",icon:"group",size:"md","text-color":"white",onClick:t[1]||(t[1]=t=>e.$store.dispatch("chats/edit",!0))}),(0,a.Lk)("b",X,(0,i.v_)(o.chatName),1)]),_:1}),(0,a.Lk)("div",I,[(0,a.Lk)("div",T,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.reversedMessages,(e,t)=>((0,a.uX)(),(0,a.Wv)(m,{key:t,message:e},null,8,["message"]))),128))])],512),(0,a.bF)(g,null,{default:(0,a.k6)(()=>[(0,a.bF)(u,{class:"q-pa-sm"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{modelValue:e.message.crmMessage,"onUpdate:modelValue":t[2]||(t[2]=t=>e.message.crmMessage=t),"bg-color":"white",class:"full-width",dense:"",label:"Bericht",outlined:"",rounded:"",onKeydown:(0,Q.jR)(o.filterStrokes,["enter"])},{after:(0,a.k6)(()=>[(0,a.bF)(r,{color:"white",dense:"",flat:"",icon:"send",round:"",onClick:o.sendMessage},null,8,["onClick"])]),_:1},8,["modelValue","onKeydown"])]),_:1})]),_:1})]),_:1})}const D={key:0},E=["innerHTML"],W=["innerHTML"],j={key:1},H={key:2},V={key:3},z={key:4},R={key:1},S=["innerHTML"];function B(e,t,s,l,n,o){const r=(0,a.g2)("q-chat-message");return(0,a.uX)(),(0,a.Wv)(r,{"bg-color":o.bgColor,name:o.name,sent:o.isMe,stamp:o.timeText,size:"10"},{default:(0,a.k6)(()=>[s.message.crmFltNr>0?((0,a.uX)(),(0,a.CE)("div",D,[(0,a.Lk)("span",{innerHTML:s.message.flightText},null,8,E),t[7]||(t[7]=(0,a.Lk)("br",null,null,-1)),s.message.canceled?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("span",{key:0,innerHTML:s.message.flightExtraText},null,8,W)),t[8]||(t[8]=(0,a.Lk)("hr",null,null,-1)),s.message.canceled?((0,a.uX)(),(0,a.CE)("span",j,t[1]||(t[1]=[(0,a.Lk)("b",null,"Status",-1),(0,a.eW)(": geannuleerd",-1),(0,a.Lk)("br",null,null,-1)]))):s.message.on_flight?((0,a.uX)(),(0,a.CE)("span",H,t[2]||(t[2]=[(0,a.Lk)("b",null,"Status",-1),(0,a.eW)(": je bent deelnemer",-1)]))):o.showJoin?((0,a.uX)(),(0,a.CE)("span",V,[t[4]||(t[4]=(0,a.Lk)("b",null,"Status",-1)),t[5]||(t[5]=(0,a.eW)(": open ",-1)),(0,a.Lk)("a",{onClick:t[0]||(t[0]=e=>o.handleBook(s.message.crmFltNr))},t[3]||(t[3]=[(0,a.Lk)("b",null,"aanmelden",-1)]))])):(0,a.Q3)("",!0),t[9]||(t[9]=(0,a.Lk)("hr",null,null,-1)),s.message.players.length>0&&!s.message.canceled?((0,a.uX)(),(0,a.CE)("div",z,[t[6]||(t[6]=(0,a.Lk)("b",null,"Deelnemers:",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.message.players,(e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t}," - "+(0,i.v_)(e),1))),128))])):(0,a.Q3)("",!0)])):null===s.message.crmFltNr?((0,a.uX)(),(0,a.CE)("div",R,[(0,a.Lk)("span",{innerHTML:s.message.crmMessage},null,8,S)])):(0,a.Q3)("",!0)]),_:1},8,["bg-color","name","sent","stamp"])}const G={props:{message:Object},computed:{showJoin(){return this.message.crmFltNr&&!this.message.canceled&&!this.message.on_flight&&!this.message.is_my_flight},bgColor(){return this.message.crmFltNr>0&&this.message.canceled?"red-3":this.message.crmFltNr>0&&this.message.on_flight?"blue-5":this.message.crmFltNr>0?"blue-3":this.isMe?"green-3":"white"},isMe(){return this.message.crmRelNr===this.$store.state.currentUser.item.relNr},timeText(){const e=this.$dayjs(this.message.crmTimestamp),t=this.$dayjs();return e.isSame(t,"day")?e.format("HH:mm"):e.isSame(t,"year")?e.format("DD MMM HH:mm"):e.format("DD MMM YY HH:mm")},name(){return this.message.crmRelNr===this.$store.state.currentUser.item.relNr?"":this.message.sender_name}},methods:{handleBook(e){let t={fltNr:e,chtNr:this.message.crmChtNr};this.$http.post("golfer/booking/join",t).then(()=>{const e=this.$store.state.chats.chat.chtNr;this.$store.dispatch("chats/getMessages",e)})}}};var U=s(7940);const K=(0,p.A)(G,[["render",B]]),O=K;w()(G,"components",{QChatMessage:U.A});const P={components:{ChatMessage:O},data:function(){return{message:{crmChtNr:null,crmMessage:""}}},async mounted(){await this.getMessages(),await this.scrollToBottom()},computed:{reversedMessages(){return[...this.$store.state.chats.messages].reverse()},chatName(){return this.$store.state.chats.chat.chtName}},watch:{async reversedMessages(){await this.scrollToBottom()}},methods:{async scrollToBottom(){await this.$nextTick(()=>{const e=this.$refs.scrollContainer;e&&(e.scrollTop=e.scrollHeight)})},filterStrokes(e){"Enter"===e.key&&this.sendMessage()},async getMessages(){try{await this.$store.dispatch("chats/getMessages",this.$store.state.chats.chat.chtNr)}catch(e){console.error("Error fetching messages:",e)}},async sendMessage(){this.message.crmChtNr=this.$store.state.chats.chat.chtNr;try{await this.$store.dispatch("chats/setMessage",this.message),this.resetMessage()}catch(e){console.error("Error sending message:",e)}},resetMessage(){Object.assign(this.message,{crmChtNr:null,crmMessage:""})}}};var J=s(5795),Y=s(7163),Z=s(8593),ee=s(7316);const te=(0,p.A)(P,[["render",x],["__scopeId","data-v-cb924a0c"]]),se=te;w()(P,"components",{QPage:A.A,QBanner:J.A,QBtn:F.A,QAvatar:b.A,QFooter:Y.A,QToolbar:Z.A,QInput:ee.A});const ae={class:"row q-pa-sm"},le={key:0,class:"q-ml-sm"},ne={key:1,class:"q-ml-sm"};function oe(e,t,s,l,n,o){const r=(0,a.g2)("q-icon"),i=(0,a.g2)("q-input"),c=(0,a.g2)("chat-relation-item"),h=(0,a.g2)("q-list"),m=(0,a.g2)("q-btn"),d=(0,a.g2)("q-avatar"),u=(0,a.g2)("q-card-section"),g=(0,a.g2)("q-card-actions"),p=(0,a.g2)("q-card"),f=(0,a.g2)("q-dialog"),k=(0,a.g2)("q-page"),b=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(k,{class:"flex q-pa-md"},{default:(0,a.k6)(()=>[(0,a.Lk)("div",ae,[(0,a.Lk)("div",{class:"col-2",onClick:t[0]||(t[0]=t=>e.$store.dispatch("chats/edit",!1))},[(0,a.bF)(r,{name:"arrow_back_ios",size:"sm"})]),t[5]||(t[5]=(0,a.Lk)("div",{class:"col-8 text-center",style:{"font-size":"18px"}}," Groepsinformatie ",-1)),t[6]||(t[6]=(0,a.Lk)("div",{class:"col-2"},"Â ",-1))]),(0,a.bF)(i,{modelValue:e.form.chtName,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.chtName=t),class:"full-width",dense:"",label:"Naam"},{append:(0,a.k6)(()=>[(0,a.bF)(r,{name:"save",onClick:t[1]||(t[1]=t=>e.$store.dispatch("chats/setChat",e.form))})]),_:1},8,["modelValue"]),t[7]||(t[7]=(0,a.eW)(" U kunt vrienden uitnodigen voor uw clubjes. Geef een e-mailadres op en wij controleren of uw vriend in ons relatiebestand aanwezig is. ",-1)),(0,a.bF)(i,{modelValue:e.email,"onUpdate:modelValue":t[3]||(t[3]=t=>e.email=t),disable:null===this.$store.state.chats.chat.chtNr,class:"full-width",label:"Nodig uit voor groep"},{append:(0,a.k6)(()=>[(0,a.bF)(r,{disable:null===this.$store.state.chats.chat.chtNr,name:"send",onClick:o.handleInvite},null,8,["disable","onClick"])]),_:1},8,["modelValue","disable"]),(0,a.bF)(h,{bordered:"",class:"q-mt-md",separator:""},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.relations,(e,t)=>((0,a.uX)(),(0,a.Wv)(c,{key:t,item:e,relation:e.relation},null,8,["item","relation"]))),128))]),_:1}),(0,a.bF)(m,{disable:null===this.$store.state.chats.chat.chtNr,class:"full-width q-mt-md",color:"red",label:"Delete groep",outline:"",onClick:o.handleDeleteChat},null,8,["disable","onClick"]),(0,a.bF)(m,{disable:null===this.$store.state.chats.chat.chtNr,class:"full-width q-mt-md",color:"red",label:"Verlaat groep",outline:"",onClick:o.handleLeaveGroup},null,8,["disable","onClick"]),(0,a.bF)(f,{modelValue:e.showConfirm,"onUpdate:modelValue":t[4]||(t[4]=t=>e.showConfirm=t),persistent:""},{default:(0,a.k6)(()=>[(0,a.bF)(p,null,{default:(0,a.k6)(()=>[(0,a.bF)(u,{class:"row items-center"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"red",icon:"delete","text-color":"white"}),e.confirmDeleteChat?((0,a.uX)(),(0,a.CE)("span",le,"Weet u zeker dat u deze groep witl verwijderen? Deze actie kan niet teruggedraaid worden!")):e.confirmLeaveGroup?((0,a.uX)(),(0,a.CE)("span",ne,"Weet u zeker dat u deze groep witl verlaten?")):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(g,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bo)((0,a.bF)(m,{color:"primary",flat:"",label:"Annuleer",onClick:o.cancelConfirm},null,8,["onClick"]),[[b]]),(0,a.bo)((0,a.bF)(m,{label:"Ja, "+(e.confirmDeleteChat?"verwijder":"groep verlaten"),color:"primary",flat:"",onClick:o.handleDelete},null,8,["label","onClick"]),[[b]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1,__:[7]})}const re={class:"row"},ie={class:"col-4 text-right"},ce={class:"row"},he={class:"col-12"};function me(e,t,s,l,n,o){const r=(0,a.g2)("q-img"),c=(0,a.g2)("q-item-section"),h=(0,a.g2)("q-item"),m=(0,a.gN)("ripple");return(0,a.bo)(((0,a.uX)(),(0,a.Wv)(h,{clickable:""},{default:(0,a.k6)(()=>[(0,a.bF)(c,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,{src:e.base64Image,height:"40px",style:{"border-radius":"50%"},width:"40px"},null,8,["src"])]),_:1}),(0,a.bF)(c,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",re,[(0,a.Lk)("div",{class:(0,i.C4)(o.isAdmin?"col-8":"col-12")},[(0,a.Lk)("b",null,(0,i.v_)(s.relation.full_name2),1)],2),(0,a.Lk)("div",ie,(0,i.v_)(o.isAdminText),1)]),(0,a.Lk)("div",ce,[(0,a.Lk)("div",he,(0,i.v_)(s.relation.relEmail),1)])]),_:1})]),_:1})),[[m]])}const de={props:{relation:Object,item:Object},data:function(){return{image:"",base64Image:""}},computed:{isAdmin(){return 1===this.item.crrAdmin},isAdminText(){return this.isAdmin?"beheerder":""}},async mounted(){await this.loadImage()},methods:{async loadImage(){let e=this.relation.relImage;e=""===e?"empty":e;const t="public/image?name="+e,s=await this.$http({method:"get",url:t});this.base64Image=`data:image/jpeg;base64,${s}`}}};var ue=s(24);const ge=(0,p.A)(de,[["render",me]]),pe=ge;w()(de,"components",{QItem:f.A,QItemSection:k.A,QImg:ue.A}),w()(de,"directives",{Ripple:v.A});const fe={components:{ChatRelationItem:pe},data:function(){return{form:null,isNew:null===this.$store.state.chats.chat.chtNr,email:"",showConfirm:!1,confirmDeleteChat:!1,confirmLeaveGroup:!1}},watch:{confirmDeleteChat(e){this.showConfirm=e},confirmLeaveGroup(e){this.showConfirm=e}},created:function(){this.form=this.$store.state.chats.chat},unmounted(){this.isNew&&this.$store.dispatch("chats/fetchChats")},computed:{relations(){return this.$store.state.chats.relations}},methods:{handleInvite(){const e={chtNr:this.$store.state.chats.chat.chtNr,email:this.email};this.$store.dispatch("chats/invite",e)},getImageUrl(e){return`golfer/image?name=${encodeURIComponent(e)}&t=${(new Date).getTime()}`},handleDeleteChat(){this.confirmDeleteChat=!0},handleLeaveGroup(){this.confirmLeaveGroup=!0},cancelConfirm(){this.confirmDeleteChat=!1,this.confirmLeaveGroup=!1},handleDelete(){this.confirmDeleteChat?this.$store.dispatch("chats/delete"):this.confirmLeaveGroup}}};var ke=s(8219),be=s(2659),ve=s(4483),Ce=s(1656),we=s(9204),_e=s(5895);const ye=(0,p.A)(fe,[["render",oe]]),Le=ye;w()(fe,"components",{QPage:A.A,QIcon:ke.A,QInput:ee.A,QList:$.A,QBtn:F.A,QDialog:be.A,QCard:ve.A,QCardSection:Ce.A,QAvatar:b.A,QCardActions:we.A}),w()(fe,"directives",{ClosePopup:_e.A});const Ae={components:{ChatForm:Le,ChatMessages:se,ChatList:M},data:function(){return{form:{chtNr:null,chtName:"",chat_relations:[],chat_messages:[]}}},methods:{async handleSave(){await this.$store.dispatch("chats/setChat",this.chat)},handleNew(){this.$store.dispatch("chats/set",{chat:{...this.form},edit:!0})}}},Ne=(0,p.A)(Ae,[["render",l]]),Fe=Ne}}]);