"use strict";(globalThis["webpackChunkintogolf_app_golfer"]=globalThis["webpackChunkintogolf_app_golfer"]||[]).push([[964],{9964:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Xe});var a=s(7408);function l(e,t,s,l,n,i){const r=(0,a.E1)("chat-messages"),o=(0,a.E1)("chat-form"),c=(0,a.E1)("chat-list"),h=(0,a.E1)("q-page-container");return(0,a.Wz)(),(0,a.Az)(h,null,{default:(0,a.Ql)((()=>[null===e.$store.state.chats.chat||e.$store.state.chats.edit?null!==e.$store.state.chats.chat&&e.$store.state.chats.edit?((0,a.Wz)(),(0,a.Az)(o,{key:1})):((0,a.Wz)(),(0,a.Az)(c,{key:2,onHandleNew:i.handleNew},null,8,["onHandleNew"])):((0,a.Wz)(),(0,a.Az)(r,{key:0}))])),_:1})}const n={class:"row q-mb-sm",style:{"font-size":"24px","font-weight":"bold"}},i=(0,a.QD)("div",{class:"col-9"},"Chats",-1),r={class:"col-3 justify-end text-right"};function o(e,t,s,l,o,c){const h=(0,a.E1)("q-btn"),m=(0,a.E1)("chat-list-item"),d=(0,a.E1)("q-list"),u=(0,a.E1)("q-pull-to-refresh"),g=(0,a.E1)("q-page");return(0,a.Wz)(),(0,a.Az)(g,{class:"q-pa-sm"},{default:(0,a.Ql)((()=>[(0,a.K2)(u,{onRefresh:c.onRefresh},{default:(0,a.Ql)((()=>[(0,a.QD)("div",n,[i,(0,a.QD)("div",r,[(0,a.K2)(h,{color:"primary",flat:"",icon:"add",round:"",size:"small",onClick:t[0]||(t[0]=t=>e.$emit("handleNew"))})])]),(0,a.K2)(d,{bordered:"",separator:""},{default:(0,a.Ql)((()=>[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(e.$store.state.chats.chats,((e,t)=>((0,a.Wz)(),(0,a.Az)(m,{key:t,item:e},null,8,["item"])))),128))])),_:1})])),_:1},8,["onRefresh"])])),_:1})}var c=s(9912);const h={class:"row",style:{height:"24px"}},m={class:"col-6"},d={class:"col-6 text-right"},u={class:"row"};function g(e,t,s,l,n,i){const r=(0,a.E1)("q-avatar"),o=(0,a.E1)("q-item-section"),g=(0,a.E1)("q-item"),p=(0,a.iS)("ripple");return(0,a.wt)(((0,a.Wz)(),(0,a.Az)(g,{clickable:"",onClick:t[0]||(t[0]=t=>e.$store.dispatch("chats/set",{chat:s.item,edit:!1}))},{default:(0,a.Ql)((()=>[(0,a.K2)(o,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{color:"blue",icon:"group","text-color":"white"})])),_:1}),(0,a.K2)(o,null,{default:(0,a.Ql)((()=>[(0,a.QD)("div",h,[(0,a.QD)("div",m,[(0,a.QD)("b",null,(0,c.WA)(s.item.chtName),1)]),(0,a.QD)("div",d,(0,c.WA)(s.item.lastMessageTime),1)]),(0,a.QD)("div",u,(0,c.WA)(s.item.lastMessageText),1)])),_:1})])),_:1})),[[p]])}const p={props:{item:Object}};var f=s(4032),Q=s(596),v=s(9328),b=s(8144),D=s(588),w=s(5488),C=s.n(w);const $=(0,f.c)(p,[["render",g]]),z=$;C()(p,"components",{QItem:Q.c,QItemSection:v.c,QAvatar:b.c}),C()(p,"directives",{Ripple:D.c});const y={components:{ChatListItem:z},methods:{onRefresh(e){this.$store.dispatch("chats/fetchChats").then((()=>{e()}))}}};var k=s(6207),A=s(3756),q=s(5824),N=s(4604);const W=(0,f.c)(y,[["render",o]]),x=W;C()(y,"components",{QPage:k.c,QPullToRefresh:A.c,QBtn:q.c,QList:N.c});var _=s(8624);const E={ref:"messageHeaderSpace",class:"row message-fixed-top-menu fixed-top"},M={class:"q-pl-sm"},S=(0,a.QD)("div",{class:"col-1 justify-end text-right"}," ",-1),K={ref:"messagesSpace",class:"message-space"},I={ref:"messageInputSpace",class:"message-fixed-bottom-input fixed-bottom"},H={class:"row"},T={class:"col-12"};function j(e,t,s,l,n,i){const r=(0,a.E1)("q-btn"),o=(0,a.E1)("q-avatar"),h=(0,a.E1)("chat-message"),m=(0,a.E1)("q-page");return(0,a.Wz)(),(0,a.Az)(m,{ref:"messageParent",class:"message-parent",style:{"background-color":"lightgrey"}},{default:(0,a.Ql)((()=>[(0,a.QD)("div",E,[(0,a.QD)("div",{class:"col-2",onClick:t[0]||(t[0]=t=>e.$store.dispatch("chats/close"))},[(0,a.K2)(r,{color:"primary",flat:"",icon:"arrow_back_ios",round:""})]),(0,a.QD)("div",{class:"col-9",style:{"font-size":"18px"},onClick:t[1]||(t[1]=t=>e.$store.dispatch("chats/edit",!0))},[(0,a.K2)(o,{color:"blue",icon:"group",size:"md","text-color":"white"}),(0,a.QD)("b",M,(0,c.WA)(e.$store.state.chats.chat.chtName),1)]),S],512),(0,a.QD)("div",K,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(this.$store.state.chats.messages,((e,t)=>((0,a.Wz)(),(0,a.Az)(h,{key:t,message:e},null,8,["message"])))),128))],512),(0,a.QD)("div",I,[(0,a.QD)("div",H,[(0,a.QD)("div",T,[(0,a.wt)((0,a.QD)("textarea",{ref:"messageTextarea","onUpdate:modelValue":t[2]||(t[2]=t=>e.message.crmMessage=t),onKeydown:t[3]||(t[3]=(0,_.jj)((0,_.Y7)(((...e)=>i.filterStrokes&&i.filterStrokes(...e)),["prevent"]),["enter"]))},null,544),[[_.Og,e.message.crmMessage]])])])],512)])),_:1},512)}const L={key:0},R=["innerHTML"],V=(0,a.QD)("br",null,null,-1),G=["innerHTML"],B=(0,a.QD)("hr",null,null,-1),U={key:1},F=(0,a.QD)("b",null,"Status",-1),P=(0,a.QD)("br",null,null,-1),Y={key:2},O=(0,a.QD)("b",null,"Status",-1),J={key:3},X=(0,a.QD)("b",null,"Status",-1),Z=(0,a.QD)("b",null,"aanmelden",-1),ee=[Z],te=(0,a.QD)("hr",null,null,-1),se={key:4},ae=(0,a.QD)("b",null,"Deelnemers:",-1),le={key:1},ne=["innerHTML"];function ie(e,t,s,l,n,i){const r=(0,a.E1)("q-chat-message");return(0,a.Wz)(),(0,a.Az)(r,{"bg-color":i.bgColor,name:i.name,sent:i.isMe,stamp:i.timeText,size:"8"},{default:(0,a.Ql)((()=>[s.message.crmFltNr>0?((0,a.Wz)(),(0,a.An)("div",L,[(0,a.QD)("span",{innerHTML:s.message.flightText},null,8,R),V,s.message.canceled?(0,a.g1)("",!0):((0,a.Wz)(),(0,a.An)("span",{key:0,innerHTML:s.message.flightExtraText},null,8,G)),B,s.message.canceled?((0,a.Wz)(),(0,a.An)("span",U,[F,(0,a.mY)(": geannuleerd"),P])):s.message.on_flight?((0,a.Wz)(),(0,a.An)("span",Y,[O,(0,a.mY)(": je bent deelnemer")])):i.showJoin?((0,a.Wz)(),(0,a.An)("span",J,[X,(0,a.mY)(": open "),(0,a.QD)("a",{onClick:t[0]||(t[0]=e=>i.handleBook(s.message.crmFltNr))},ee)])):(0,a.g1)("",!0),te,s.message.players.length>0&&!s.message.canceled?((0,a.Wz)(),(0,a.An)("div",se,[ae,((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(s.message.players,((e,t)=>((0,a.Wz)(),(0,a.An)("div",{key:t}," - "+(0,c.WA)(e),1)))),128))])):(0,a.g1)("",!0)])):null===s.message.crmFltNr?((0,a.Wz)(),(0,a.An)("div",le,[(0,a.QD)("span",{innerHTML:s.message.crmMessage},null,8,ne)])):(0,a.g1)("",!0)])),_:1},8,["bg-color","name","sent","stamp"])}const re={props:{message:Object},computed:{showJoin(){return this.message.crmFltNr&&!this.message.canceled&&!this.message.on_flight&&!this.message.is_my_flight},bgColor(){return this.message.crmFltNr>0&&this.message.canceled?"red-3":this.message.crmFltNr>0&&this.message.on_flight?"blue-5":this.message.crmFltNr>0?"blue-3":this.isMe?"green-3":"white"},isMe(){return this.message.crmRelNr===this.$store.state.currentUser.item.relNr},timeText(){const e=this.$dayjs(this.message.crmTimestamp),t=this.$dayjs();return e.isSame(t,"day")?e.format("HH:mm"):e.isSame(t,"year")?e.format("DD MMM HH:mm"):e.format("DD MMM YY HH:mm")},name(){return this.message.crmRelNr===this.$store.state.currentUser.item.relNr?"":this.message.sender_name}},methods:{handleBook(e){let t={fltNr:e,chtNr:this.message.crmChtNr};this.$http.post("golfer/booking/join",t).then((()=>{const e=this.$store.state.chats.chat.chtNr;this.$store.dispatch("chats/getMessages",e)}))}}};var oe=s(6712);const ce=(0,f.c)(re,[["render",ie]]),he=ce;C()(re,"components",{QChatMessage:oe.c});const me={components:{ChatMessage:he},data:function(){return{message:{crmChtNr:null,crmMessage:""}}},created(){this.getMessages()},mounted(){window.addEventListener("resize",this.handleResize),this.handleResize()},watch:{"message.crmMessage":function(){this.adjustInputHeight()}},methods:{handleResize(){const e=document.querySelectorAll(".q-header");e.forEach((e=>{this.$refs.messageHeaderSpace.style.marginTop=`${e.clientHeight}px`}));const t=this.$refs.messageHeaderSpace.getBoundingClientRect(),s=this.$refs.messageInputSpace.getBoundingClientRect(),a=s.top-t.bottom;this.$refs.messagesSpace.style.height=`${a}px`},filterStrokes(e){13===e.keyCode?this.sendMessage():e.shiftKey||(e.preventDefault(),this.message.trim()&&(this.message=""))},async getMessages(){await this.$store.dispatch("chats/getMessages",this.$store.state.chats.chat.chtNr)},async sendMessage(){this.message.crmChtNr=this.$store.state.chats.chat.chtNr,await this.$store.dispatch("chats/setMessage",this.message),this.resetMessage()},resetMessage(){this.message={crmChtNr:null,crmMessage:""},this.$refs.messagesSpace.scrollTop=0},adjustInputHeight(){this.$nextTick((()=>{const e=this.$refs.messageInputSpace?.querySelector("textarea");if(e){e.style.height="auto";let t=e.scrollHeight;t<58&&(t=58),t>150&&(t=150),e.style.height=`${t}px`,document.documentElement.style.setProperty("--input-height",`${t}px`);const s=this.$refs.messageHeaderSpace.getBoundingClientRect(),a=this.$refs.messageInputSpace.getBoundingClientRect(),l=a.top-s.bottom;this.$refs.messagesSpace.style.height=`${l}px`,this.$refs.messagesSpace.style.bottom=`${a.height}px`}}))}}};var de=s(9432);const ue=(0,f.c)(me,[["render",j]]),ge=ue;C()(me,"components",{QPage:k.c,QBtn:q.c,QAvatar:b.c,QHeader:de.c});const pe={class:"row q-pa-sm chat-form"},fe=(0,a.QD)("div",{class:"col-8 text-center",style:{"font-size":"18px"}}," Groepsinformatie ",-1),Qe=(0,a.QD)("div",{class:"col-2"}," ",-1),ve={class:"row q-pa-sm"},be={class:"col-12"},De=(0,a.QD)("div",{class:"row q-pa-sm",style:{"font-size":"14px","font-weight":"bold"}},[(0,a.QD)("div",{class:"col-12"}," U kunt vrienden uitnodigen voor uw clubjes. Geef een e-mailadres op en wij controleren of uw vriend in ons relatiebestand aanwezig is. ")],-1),we={class:"row q-pa-sm"},Ce={class:"col-12"},$e={class:"row q-pa-sm"},ze={class:"col-12"},ye={class:"row q-pa-sm"},ke={class:"col-12"},Ae={key:0,class:"q-ml-sm"},qe={key:1,class:"q-ml-sm"};function Ne(e,t,s,l,n,i){const r=(0,a.E1)("q-icon"),o=(0,a.E1)("q-input"),c=(0,a.E1)("chat-relation-item"),h=(0,a.E1)("q-list"),m=(0,a.E1)("q-btn"),d=(0,a.E1)("q-avatar"),u=(0,a.E1)("q-card-section"),g=(0,a.E1)("q-card-actions"),p=(0,a.E1)("q-card"),f=(0,a.E1)("q-dialog"),Q=(0,a.E1)("q-page"),v=(0,a.iS)("close-popup");return(0,a.Wz)(),(0,a.Az)(Q,null,{default:(0,a.Ql)((()=>[(0,a.QD)("div",pe,[(0,a.QD)("div",{class:"col-2",onClick:t[0]||(t[0]=t=>e.$store.dispatch("chats/edit",!1))},[(0,a.K2)(r,{name:"arrow_back_ios",size:"sm"})]),fe,Qe]),(0,a.QD)("div",ve,[(0,a.QD)("div",be,[(0,a.K2)(o,{modelValue:e.form.chtName,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.chtName=t),class:"q-mb-md",label:"Naam"},{append:(0,a.Ql)((()=>[(0,a.K2)(r,{name:"save",onClick:t[1]||(t[1]=t=>e.$store.dispatch("chats/setChat",e.form))})])),_:1},8,["modelValue"])])]),De,(0,a.QD)("div",we,[(0,a.QD)("div",Ce,[(0,a.K2)(o,{modelValue:e.email,"onUpdate:modelValue":t[3]||(t[3]=t=>e.email=t),disable:null===this.$store.state.chats.chat.chtNr,label:"Nodig uit voor groep"},{append:(0,a.Ql)((()=>[(0,a.K2)(r,{disable:null===this.$store.state.chats.chat.chtNr,name:"send",onClick:i.handleInvite},null,8,["disable","onClick"])])),_:1},8,["modelValue","disable"])])]),(0,a.QD)("div",$e,[(0,a.QD)("div",ze,[(0,a.K2)(h,{bordered:"",class:"q-mt-md",separator:""},{default:(0,a.Ql)((()=>[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(i.relations,((e,t)=>((0,a.Wz)(),(0,a.Az)(c,{key:t,item:e,relation:e.relation},null,8,["item","relation"])))),128))])),_:1})])]),(0,a.QD)("div",ye,[(0,a.QD)("div",ke,[(0,a.K2)(m,{disable:null===this.$store.state.chats.chat.chtNr,class:"full-width q-mt-md",color:"red",label:"Delete groep",outline:"",onClick:i.handleDeleteChat},null,8,["disable","onClick"]),(0,a.K2)(m,{disable:null===this.$store.state.chats.chat.chtNr,class:"full-width q-mt-md",color:"red",label:"Verlaat groep",outline:"",onClick:i.handleLeaveGroup},null,8,["disable","onClick"])])]),(0,a.K2)(f,{modelValue:e.showConfirm,"onUpdate:modelValue":t[4]||(t[4]=t=>e.showConfirm=t),persistent:""},{default:(0,a.Ql)((()=>[(0,a.K2)(p,null,{default:(0,a.Ql)((()=>[(0,a.K2)(u,{class:"row items-center"},{default:(0,a.Ql)((()=>[(0,a.K2)(d,{color:"red",icon:"delete","text-color":"white"}),e.confirmDeleteChat?((0,a.Wz)(),(0,a.An)("span",Ae,"Weet u zeker dat u deze groep witl verwijderen? Deze actie kan niet teruggedraaid worden!")):e.confirmLeaveGroup?((0,a.Wz)(),(0,a.An)("span",qe,"Weet u zeker dat u deze groep witl verlaten?")):(0,a.g1)("",!0)])),_:1}),(0,a.K2)(g,{align:"right"},{default:(0,a.Ql)((()=>[(0,a.wt)((0,a.K2)(m,{color:"primary",flat:"",label:"Annuleer",onClick:i.cancelConfirm},null,8,["onClick"]),[[v]]),(0,a.wt)((0,a.K2)(m,{label:"Ja, "+(e.confirmDeleteChat?"verwijder":"groep verlaten"),color:"primary",flat:"",onClick:i.handleDelete},null,8,["label","onClick"]),[[v]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}const We={class:"row"},xe={class:"col-4 text-right"},_e={class:"row"},Ee={class:"col-12"};function Me(e,t,s,l,n,i){const r=(0,a.E1)("q-img"),o=(0,a.E1)("q-item-section"),h=(0,a.E1)("q-item"),m=(0,a.iS)("ripple");return(0,a.wt)(((0,a.Wz)(),(0,a.Az)(h,{clickable:""},{default:(0,a.Ql)((()=>[(0,a.K2)(o,{avatar:""},{default:(0,a.Ql)((()=>[(0,a.K2)(r,{src:e.base64Image,height:"40px",style:{"border-radius":"50%"},width:"40px"},null,8,["src"])])),_:1}),(0,a.K2)(o,null,{default:(0,a.Ql)((()=>[(0,a.QD)("div",We,[(0,a.QD)("div",{class:(0,c.WN)(i.isAdmin?"col-8":"col-12")},[(0,a.QD)("b",null,(0,c.WA)(s.relation.full_name2),1)],2),(0,a.QD)("div",xe,(0,c.WA)(i.isAdminText),1)]),(0,a.QD)("div",_e,[(0,a.QD)("div",Ee,(0,c.WA)(s.relation.relEmail),1)])])),_:1})])),_:1})),[[m]])}const Se={props:{relation:Object,item:Object},data:function(){return{image:"",base64Image:""}},computed:{isAdmin(){return 1===this.item.crrAdmin},isAdminText(){return this.isAdmin?"beheerder":""}},async mounted(){await this.loadImage()},methods:{async loadImage(){let e=this.relation.relImage;e=""===e?"empty":e;const t="golfer/image/"+e,s=await this.$http({method:"get",url:t});this.base64Image=`data:image/jpeg;base64,${s}`}}};var Ke=s(5832);const Ie=(0,f.c)(Se,[["render",Me]]),He=Ie;C()(Se,"components",{QItem:Q.c,QItemSection:v.c,QImg:Ke.c}),C()(Se,"directives",{Ripple:D.c});const Te={components:{ChatRelationItem:He},data:function(){return{form:null,isNew:null===this.$store.state.chats.chat.chtNr,email:"",showConfirm:!1,confirmDeleteChat:!1,confirmLeaveGroup:!1}},watch:{confirmDeleteChat(e){this.showConfirm=e},confirmLeaveGroup(e){this.showConfirm=e}},created:function(){this.form=this.$store.state.chats.chat},unmounted(){this.isNew&&this.$store.dispatch("chats/fetchChats")},computed:{relations(){return this.$store.state.chats.relations}},methods:{handleInvite(){const e={chtNr:this.$store.state.chats.chat.chtNr,email:this.email};this.$store.dispatch("chats/invite",e)},getImageUrl(e){return`public/image?name=${encodeURIComponent(e)}&t=${(new Date).getTime()}`},handleDeleteChat(){this.confirmDeleteChat=!0},handleLeaveGroup(){this.confirmLeaveGroup=!0},cancelConfirm(){this.confirmDeleteChat=!1,this.confirmLeaveGroup=!1},handleDelete(){this.confirmDeleteChat?this.$store.dispatch("chats/delete"):this.confirmLeaveGroup}}};var je=s(6072),Le=s(7644),Re=s(9340),Ve=s(8064),Ge=s(3616),Be=s(5776),Ue=s(148);const Fe=(0,f.c)(Te,[["render",Ne]]),Pe=Fe;C()(Te,"components",{QPage:k.c,QIcon:je.c,QInput:Le.c,QList:N.c,QBtn:q.c,QDialog:Re.c,QCard:Ve.c,QCardSection:Ge.c,QAvatar:b.c,QCardActions:Be.c}),C()(Te,"directives",{ClosePopup:Ue.c});const Ye={components:{ChatForm:Pe,ChatMessages:ge,ChatList:x},data:function(){return{form:{chtNr:null,chtName:"",chat_relations:[],chat_messages:[]}}},methods:{async handleSave(){await this.$store.dispatch("chats/setChat",this.chat)},handleNew(){this.$store.dispatch("chats/set",{chat:{...this.form},edit:!0})}}};var Oe=s(688);const Je=(0,f.c)(Ye,[["render",l]]),Xe=Je;C()(Ye,"components",{QPageContainer:Oe.c})}}]);