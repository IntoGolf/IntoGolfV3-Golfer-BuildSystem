"use strict";(globalThis["webpackChunkintogolf_app_golfer"]=globalThis["webpackChunkintogolf_app_golfer"]||[]).push([[704],{7704:(e,s,t)=>{t.r(s),t.d(s,{default:()=>J});var a=t(3673);function i(e,s,t,i,r,c){const l=(0,a.up)("circle-messages"),o=(0,a.up)("circle-list"),n=(0,a.up)("q-page-container");return(0,a.wg)(),(0,a.j4)(n,null,{default:(0,a.w5)((()=>[null!==e.$store.state.circles.circle?((0,a.wg)(),(0,a.j4)(l,{key:0})):((0,a.wg)(),(0,a.j4)(o,{key:1,onHandleNew:c.handleNew},null,8,["onHandleNew"]))])),_:1})}const r={class:"row q-mb-sm",style:{"font-size":"14px","font-weight":"bold"}},c=(0,a._)("div",{class:"col-9"},"Uw clubjes",-1),l={class:"col-3 justify-end text-right"};function o(e,s,t,i,o,n){const m=(0,a.up)("q-btn"),d=(0,a.up)("circle-list-item"),g=(0,a.up)("q-list"),u=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(u,null,{default:(0,a.w5)((()=>[(0,a._)("div",r,[c,(0,a._)("div",l,[(0,a.Wm)(m,{color:"primary",flat:"",icon:"add",round:"",size:"small",onClick:s[0]||(s[0]=s=>e.$emit("handleNew"))})])]),(0,a.Wm)(g,{bordered:"",separator:""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.$store.state.circles.circles,((e,s)=>((0,a.wg)(),(0,a.j4)(d,{key:s,item:e},null,8,["item"])))),128))])),_:1})])),_:1})}var n=t(2323);const m={class:"row",style:{height:"24px"}},d={class:"col-6"},g={class:"col-6 text-right"},u={class:"row"};function p(e,s,t,i,r,c){const l=(0,a.up)("q-avatar"),o=(0,a.up)("q-item-section"),p=(0,a.up)("q-item"),h=(0,a.Q2)("ripple");return(0,a.wy)(((0,a.wg)(),(0,a.j4)(p,{clickable:"",onClick:s[0]||(s[0]=s=>e.$store.dispatch("circles/set",t.item.circle))},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{color:"blue",icon:"group","text-color":"white"})])),_:1}),(0,a.Wm)(o,null,{default:(0,a.w5)((()=>[(0,a._)("div",m,[(0,a._)("div",d,[(0,a._)("b",null,(0,n.zw)(t.item.cirName),1)]),(0,a._)("div",g,(0,n.zw)(c.lastMessageTime),1)]),(0,a._)("div",u,(0,n.zw)(c.lastMessageText),1)])),_:1})])),_:1})),[[h]])}const h={props:{item:Object},computed:{lastMessage(){return!(!this.item.circle.circle_messages||0===this.item.circle.circle_messages.length)&&this.item.circle.circle_messages[0]},lastMessageText(){return this.lastMessage?this.lastMessage.crmMessage:"..."},lastMessageTime(){return this.lastMessage?this.getDayText(this.lastMessage.crmTimestamp):""}},methods:{getDayText(e){let s=this.$dayjs(e),t=this.$dayjs(),a=t.diff(s,"day");return 0===a?s.format("HH:mm"):1===a?"gisteren":a<=7?s.format("dddd"):s.format("DD-MM-YYYY")}}};var f=t(4260),w=t(3414),M=t(2035),_=t(5096),v=t(6489),y=t(7518),b=t.n(y);const x=(0,f.Z)(h,[["render",p]]),T=x;b()(h,"components",{QItem:w.Z,QItemSection:M.Z,QAvatar:_.Z}),b()(h,"directives",{Ripple:v.Z});const j={components:{CircleListItem:T},created:function(){this.$store.dispatch("circles/fetchCircles")}};var C=t(4379),Z=t(8240),$=t(7011);const k=(0,f.Z)(j,[["render",o]]),q=k;b()(j,"components",{QPage:C.Z,QBtn:Z.Z,QList:$.Z});var D=t(8880);const H={class:"q-pa-md row justify-center"},Q={ref:"messageSpace",class:"message-fixed-bottom scroll"},N={class:"message-fixed-bottom-input"},S={class:"row q-mb-md"},Y={class:"col-10"},W={class:"col-2 text-right",style:{"padding-right":"5px","padding-top":"40px"}};function B(e,s,t,i,r,c){const l=(0,a.up)("circle-message"),o=(0,a.up)("q-input"),n=(0,a.up)("q-btn");return(0,a.wg)(),(0,a.iD)("div",H,[(0,a._)("div",Q,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(c.messages,((e,s)=>((0,a.wg)(),(0,a.j4)(l,{key:s,message:e},null,8,["message"])))),128))],512),(0,a._)("div",N,[(0,a._)("div",S,[(0,a._)("div",Y,[(0,a.Wm)(o,{modelValue:e.message.crmMessage,"onUpdate:modelValue":s[0]||(s[0]=s=>e.message.crmMessage=s),"label-slot":!1,rows:4,"auto-grow":"",class:"message-textarea",placeholder:"Type een bericht",standout:"",type:"textarea",onKeydown:(0,D.D2)((0,D.iM)(c.filterStrokes,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])]),(0,a._)("div",W,[(0,a.Wm)(n,{color:"primary",icon:"send",round:"",onClick:c.sendMessage},null,8,["onClick"])])])])])}function z(e,s,t,i,r,c){const l=(0,a.up)("q-chat-message");return(0,a.wg)(),(0,a.j4)(l,{name:c.name,sent:t.message.is_me,stamp:c.timeText,text:[t.message.crmMessage],"bg-color":"amber-7"},null,8,["name","sent","stamp","text"])}const K={props:{message:Object},computed:{timeText(){const e=this.$dayjs(this.message.crmTimestamp),s=this.$dayjs();return e.isSame(s,"day")?e.format("HH:mm"):e.isSame(s,"year")?e.format("DD MMM HH:mm"):e.format("DD MMM YY HH:mm")},name(){return this.message.is_me?"":this.message.sender_name}},methods:{}};var I=t(629);const L=(0,f.Z)(K,[["render",z]]),V=L;b()(K,"components",{QChatMessage:I.Z});const O={components:{CircleMessage:V},data:function(){return{message:null}},created(){this.resetMessage()},watch:{messages(){this.scrollToBottom()}},mounted(){this.scrollToBottom()},computed:{item(){return this.$store.state.circles.circle},messages(){return this.item.circle_messages}},methods:{filterStrokes(e){e.shiftKey||(e.preventDefault(),this.message.trim()&&(this.message=""))},async sendMessage(){this.message.crmCirNr=this.item.cirNr;await this.$store.dispatch("circles/setMessage",this.message);this.resetMessage(),this.scrollToBottom()},resetMessage(){this.message={crmCirNr:null,crmMessage:""}},scrollToBottom(){this.$nextTick((()=>{const e=this.$refs.messageSpace;e&&(this.$refs.messageSpace.scrollTop=366)}))}}};var P=t(4842),U=t(6115);const A=(0,f.Z)(O,[["render",B]]),F=A;b()(O,"components",{QInput:P.Z,QBtn:Z.Z,QField:U.Z});const R={components:{CircleMessages:F,CircleList:q},data:function(){return{form:{cirNr:null,cirName:"",circle_relations:[],circle_messages:[]}}},created:function(){this.$store.dispatch("circles/fetchCircles")},methods:{async handleSave(){await this.$store.dispatch("circles/setCircle",this.circle)},handleNew(){this.$store.dispatch("circles/set",{...this.form})}}};var E=t(2652);const G=(0,f.Z)(R,[["render",i]]),J=G;b()(R,"components",{QPageContainer:E.Z})}}]);