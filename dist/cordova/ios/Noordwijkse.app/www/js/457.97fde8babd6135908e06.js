"use strict";(globalThis["webpackChunkintogolf_app_golfer"]=globalThis["webpackChunkintogolf_app_golfer"]||[]).push([[457],{457:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ze});var a=s(3673);function o(e,t,s,o,i,l){const n=(0,a.up)("chat-messages"),r=(0,a.up)("chat-form"),c=(0,a.up)("chat-list"),m=(0,a.up)("q-page-container");return(0,a.wg)(),(0,a.j4)(m,null,{default:(0,a.w5)((()=>[null===e.$store.state.chats.chat||e.$store.state.chats.edit?null!==e.$store.state.chats.chat&&e.$store.state.chats.edit?((0,a.wg)(),(0,a.j4)(r,{key:1})):((0,a.wg)(),(0,a.j4)(c,{key:2,onHandleNew:l.handleNew},null,8,["onHandleNew"])):((0,a.wg)(),(0,a.j4)(n,{key:0}))])),_:1})}const i={class:"row q-mb-sm",style:{"font-size":"24px","font-weight":"bold"}},l=(0,a._)("div",{class:"col-9"},"Chats",-1),n={class:"col-3 justify-end text-right"};function r(e,t,s,o,r,c){const m=(0,a.up)("q-btn"),d=(0,a.up)("chat-list-item"),h=(0,a.up)("q-list"),u=(0,a.up)("q-pull-to-refresh"),p=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(p,{class:"q-pa-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{onRefresh:c.onRefresh},{default:(0,a.w5)((()=>[(0,a._)("div",i,[l,(0,a._)("div",n,[(0,a.Wm)(m,{color:"primary",flat:"",icon:"add",round:"",size:"small",onClick:t[0]||(t[0]=t=>e.$emit("handleNew"))})])]),(0,a.Wm)(h,{bordered:"",separator:""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.$store.state.chats.chats,((e,t)=>((0,a.wg)(),(0,a.j4)(d,{key:t,item:e},null,8,["item"])))),128))])),_:1})])),_:1},8,["onRefresh"])])),_:1})}var c=s(2323);const m={class:"row",style:{height:"24px"}},d={class:"col-6"},h={class:"col-6 text-right"},u={class:"row"};function p(e,t,s,o,i,l){const n=(0,a.up)("q-avatar"),r=(0,a.up)("q-item-section"),p=(0,a.up)("q-item"),g=(0,a.Q2)("ripple");return(0,a.wy)(((0,a.wg)(),(0,a.j4)(p,{clickable:"",onClick:t[0]||(t[0]=t=>e.$store.dispatch("chats/set",{chat:s.item,edit:!1}))},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{color:"blue",icon:"group","text-color":"white"})])),_:1}),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a._)("div",m,[(0,a._)("div",d,[(0,a._)("b",null,(0,c.zw)(s.item.chtName),1)]),(0,a._)("div",h,(0,c.zw)(s.item.lastMessageTime),1)]),(0,a._)("div",u,(0,c.zw)(s.item.lastMessageText),1)])),_:1})])),_:1})),[[g]])}const g={props:{item:Object}};var w=s(4260),f=s(3414),v=s(2035),_=s(5096),b=s(6489),y=s(7518),C=s.n(y);const k=(0,w.Z)(g,[["render",p]]),$=k;C()(g,"components",{QItem:f.Z,QItemSection:v.Z,QAvatar:_.Z}),C()(g,"directives",{Ripple:b.Z});const q={components:{ChatListItem:$},methods:{onRefresh(e){this.$store.dispatch("chats/fetchChats").then((()=>{e()}))}}};var x=s(4379),Z=s(3720),j=s(8240),N=s(7011);const Q=(0,w.Z)(q,[["render",r]]),W=Q;C()(q,"components",{QPage:x.Z,QPullToRefresh:Z.Z,QBtn:j.Z,QList:N.Z});var D=s(8880);const M={ref:"messageHeaderSpace",class:"row message-fixed-top-menu fixed-top"},I={class:"q-pl-sm"},z=(0,a._)("div",{class:"col-1 justify-end text-right"}," ",-1),H={ref:"messagesSpace",class:"message-space"},S={ref:"messageInputSpace",class:"message-fixed-bottom-input fixed-bottom"},T={class:"row"},L={class:"col-10"},K={class:"col-2 text-right",style:{"padding-right":"5px","padding-top":"5px"}};function A(e,t,s,o,i,l){const n=(0,a.up)("q-btn"),r=(0,a.up)("q-avatar"),m=(0,a.up)("chat-message"),d=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(d,{ref:"messageParent",class:"message-parent",style:{"background-color":"lightgrey"}},{default:(0,a.w5)((()=>[(0,a._)("div",M,[(0,a._)("div",{class:"col-2",onClick:t[0]||(t[0]=t=>e.$store.dispatch("chats/close"))},[(0,a.Wm)(n,{color:"primary",flat:"",icon:"arrow_back_ios",round:""})]),(0,a._)("div",{class:"col-9",style:{"font-size":"18px"},onClick:t[1]||(t[1]=t=>e.$store.dispatch("chats/edit",!0))},[(0,a.Wm)(r,{color:"blue",icon:"group",size:"md","text-color":"white"}),(0,a._)("b",I,(0,c.zw)(e.$store.state.chats.chat.chtName),1)]),z],512),(0,a._)("div",H,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.$store.state.chats.messages,((e,t)=>((0,a.wg)(),(0,a.j4)(m,{key:t,message:e},null,8,["message"])))),128))],512),(0,a._)("div",S,[(0,a._)("div",T,[(0,a._)("div",L,[(0,a.wy)((0,a._)("textarea",{ref:"messageTextarea","onUpdate:modelValue":t[2]||(t[2]=t=>e.message.crmMessage=t),onKeydown:t[3]||(t[3]=(0,D.D2)((0,D.iM)(((...e)=>l.filterStrokes&&l.filterStrokes(...e)),["prevent"]),["enter"]))},null,544),[[D.nr,e.message.crmMessage]])]),(0,a._)("div",K,[(0,a.Wm)(n,{color:"primary",icon:"send",round:"",size:"small",onClick:l.sendMessage},null,8,["onClick"]),(0,a.Wm)(n,{color:"primary",icon:"save",round:"",size:"small",onClick:l.showKeyboard},null,8,["onClick"])])])],512)])),_:1},512)}const R=["innerHTML"];function V(e,t,s,o,i,l){const n=(0,a.up)("q-btn"),r=(0,a.up)("q-chat-message");return(0,a.wg)(),(0,a.j4)(r,{name:l.name,sent:s.message.is_me,stamp:l.timeText,text:[s.message.crmMessage],"text-html":!0,"bg-color":"amber-7"},{default:(0,a.w5)((()=>[(0,a._)("div",{innerHTML:s.message.crmMessage},null,8,R),s.message.crmFltNr?((0,a.wg)(),(0,a.j4)(n,{key:0,color:"primary",onClick:t[0]||(t[0]=e=>l.handleBook(s.message.crmFltNr))},{default:(0,a.w5)((()=>[(0,a.Uk)("join ")])),_:1})):(0,a.kq)("",!0)])),_:1},8,["name","sent","stamp","text"])}const G={props:{message:Object},computed:{timeText(){const e=this.$dayjs(this.message.crmTimestamp),t=this.$dayjs();return e.isSame(t,"day")?e.format("HH:mm"):e.isSame(t,"year")?e.format("DD MMM HH:mm"):e.format("DD MMM YY HH:mm")},name(){return this.message.is_me?"":this.message.sender_name}},methods:{handleBook(e){let t={fltNr:e,chtNr:this.message.crmChtNr};this.$http.post("golfer/booking/join",t).then((e=>{console.log(e)}))}}};var P=s(629);const U=(0,w.Z)(G,[["render",V]]),B=U;C()(G,"components",{QChatMessage:P.Z,QBtn:j.Z});const Y={components:{ChatMessage:B},data:function(){return{message:null}},created(){this.resetMessage(),this.getMessages()},mounted(){this.$refs.messagesSpace.style.height=this.$q.screen.height-189+"px";const e=document.querySelectorAll(".q-header");e.forEach((e=>{console.log(e.clientHeight),this.$refs.messageHeaderSpace.style.marginTop=`${e.clientHeight}px`})),document.addEventListener("deviceready",this.onDeviceReady,!1)},watch:{"message.crmMessage":function(){this.adjustInputHeight()}},methods:{onDeviceReady(){this.showKeyboard()},showKeyboard(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&window.cordova.plugins.Keyboard.show()},hideKeyboard(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&window.cordova.plugins.Keyboard.hide()},filterStrokes(e){e.shiftKey||(e.preventDefault(),this.message.trim()&&(this.message=""))},async getMessages(){await this.$store.dispatch("chats/getMessages",this.$store.state.chats.chat.chtNr)},async sendMessage(){this.message.crmChtNr=this.$store.state.chats.chat.chtNr,await this.$store.dispatch("chats/setMessage",this.message)},resetMessage(){this.message={crmChtNr:null,crmMessage:""},setTimeout((()=>{this.$refs.messageTextarea.focus()}),100)},adjustInputHeight(){this.$nextTick((()=>{const e=this.$refs.messageInputSpace?.querySelector("textarea");if(e){e.style.height="auto";let t=e.scrollHeight;t<58&&(t=58),t>150&&(t=150),e.style.height=`${t}px`,document.documentElement.style.setProperty("--input-height",`${t}px`);let s=this.$q.screen.height,a=s-(t+150);this.$refs.messagesSpace.style.height=`${a}px`,this.$refs.messagesSpace.style.bottom=`${t+36}px`}}))}}};var E=s(3812);const O=(0,w.Z)(Y,[["render",A]]),F=O;C()(Y,"components",{QPage:x.Z,QBtn:j.Z,QAvatar:_.Z,QHeader:E.Z});const J={class:"row q-pa-sm chat-form"},X=(0,a._)("div",{class:"col-8 text-center",style:{"font-size":"18px"}}," Groepsinformatie ",-1),ee=(0,a._)("div",{class:"col-2"}," ",-1),te={class:"row q-pa-sm"},se={class:"col-12"},ae=(0,a._)("div",{class:"row q-pa-sm",style:{"font-size":"14px","font-weight":"bold"}},[(0,a._)("div",{class:"col-12"}," U kunt vrienden uitnodigen voor uw clubjes. Geef een e-mailadres op en wij controleren of uw vriend in ons relatiebestand aanwezig is. ")],-1),oe={class:"row q-pa-sm"},ie={class:"col-12"},le={class:"row q-pa-sm"},ne={class:"col-12"},re={class:"row q-pa-sm"},ce={class:"col-12"},me={key:0,class:"q-ml-sm"},de={key:1,class:"q-ml-sm"};function he(e,t,s,o,i,l){const n=(0,a.up)("q-icon"),r=(0,a.up)("q-input"),c=(0,a.up)("chat-relation-item"),m=(0,a.up)("q-list"),d=(0,a.up)("q-btn"),h=(0,a.up)("q-avatar"),u=(0,a.up)("q-card-section"),p=(0,a.up)("q-card-actions"),g=(0,a.up)("q-card"),w=(0,a.up)("q-dialog"),f=(0,a.up)("q-page"),v=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(f,null,{default:(0,a.w5)((()=>[(0,a._)("div",J,[(0,a._)("div",{class:"col-2",onClick:t[0]||(t[0]=t=>e.$store.dispatch("chats/edit",!1))},[(0,a.Wm)(n,{name:"arrow_back_ios",size:"sm"})]),X,ee]),(0,a._)("div",te,[(0,a._)("div",se,[(0,a.Wm)(r,{modelValue:e.form.chtName,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.chtName=t),class:"q-mb-md",label:"Naam"},{append:(0,a.w5)((()=>[(0,a.Wm)(n,{name:"save",onClick:t[1]||(t[1]=t=>e.$store.dispatch("chats/setChat",e.form))})])),_:1},8,["modelValue"])])]),ae,(0,a._)("div",oe,[(0,a._)("div",ie,[(0,a.Wm)(r,{modelValue:e.email,"onUpdate:modelValue":t[3]||(t[3]=t=>e.email=t),disable:null===e.form.chtNr,label:"Nodig uit voor groep"},{append:(0,a.w5)((()=>[(0,a.Wm)(n,{disable:null===e.form.chtNr,name:"send",onClick:l.handleInvite},null,8,["disable","onClick"])])),_:1},8,["modelValue","disable"])])]),(0,a._)("div",le,[(0,a._)("div",ne,[(0,a.Wm)(m,{bordered:"",class:"q-mt-md",separator:""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.relations,((e,t)=>((0,a.wg)(),(0,a.j4)(c,{key:t,item:e,relation:e.relation},null,8,["item","relation"])))),128))])),_:1})])]),(0,a._)("div",re,[(0,a._)("div",ce,[(0,a.Wm)(d,{disable:null===this.$store.state.chats.chat.chtNr,class:"full-width q-mt-md",color:"red",label:"Delete groep",outline:"",onClick:l.handleDeleteChat},null,8,["disable","onClick"]),(0,a.Wm)(d,{disable:null===this.$store.state.chats.chat.chtNr,class:"full-width q-mt-md",color:"red",label:"Verlaat groep",outline:"",onClick:l.handleLeaveGroup},null,8,["disable","onClick"])])]),(0,a.Wm)(w,{modelValue:e.showConfirm,"onUpdate:modelValue":t[4]||(t[4]=t=>e.showConfirm=t),persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"row items-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{color:"red",icon:"delete","text-color":"white"}),e.confirmDeleteChat?((0,a.wg)(),(0,a.iD)("span",me,"Weet u zeker dat u deze groep witl verwijderen? Deze actie kan niet teruggedraaid worden!")):e.confirmLeaveGroup?((0,a.wg)(),(0,a.iD)("span",de,"Weet u zeker dat u deze groep witl verlaten?")):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(p,{align:"right"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(d,{color:"primary",flat:"",label:"Annuleer",onClick:l.cancelConfirm},null,8,["onClick"]),[[v]]),(0,a.wy)((0,a.Wm)(d,{label:"Ja, "+(e.confirmDeleteChat?"verwijder":"groep verlaten"),color:"primary",flat:"",onClick:l.handleDelete},null,8,["label","onClick"]),[[v]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}const ue={class:"row"},pe={class:"col-4 text-right"},ge={class:"row"},we={class:"col-12"};function fe(e,t,s,o,i,l){const n=(0,a.up)("q-img"),r=(0,a.up)("q-item-section"),m=(0,a.up)("q-item"),d=(0,a.Q2)("ripple");return(0,a.wy)(((0,a.wg)(),(0,a.j4)(m,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{src:e.base64Image,height:"40px",style:{"border-radius":"50%"},width:"40px"},null,8,["src"])])),_:1}),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a._)("div",ue,[(0,a._)("div",{class:(0,c.C_)(l.isAdmin?"col-8":"col-12")},[(0,a._)("b",null,(0,c.zw)(s.relation.full_name2),1)],2),(0,a._)("div",pe,(0,c.zw)(l.isAdminText),1)]),(0,a._)("div",ge,[(0,a._)("div",we,(0,c.zw)(s.relation.relEmail),1)])])),_:1})])),_:1})),[[d]])}const ve={props:{relation:Object,item:Object},data:function(){return{image:"",base64Image:""}},computed:{isAdmin(){return 1===this.item.crrAdmin},isAdminText(){return this.isAdmin?"beheerder":""}},async mounted(){await this.loadImage()},methods:{async loadImage(){let e=this.relation.relImage;e=""===e?"empty":e;const t="golfer/image/"+e,s=await this.$http({method:"get",url:t});this.base64Image=`data:image/jpeg;base64,${s}`}}};var _e=s(4027);const be=(0,w.Z)(ve,[["render",fe]]),ye=be;C()(ve,"components",{QItem:f.Z,QItemSection:v.Z,QImg:_e.Z}),C()(ve,"directives",{Ripple:b.Z});const Ce={components:{ChatRelationItem:ye},data:function(){return{form:null,isNew:null===this.$store.state.chats.chat.chtNr,email:"",showConfirm:!1,confirmDeleteChat:!1,confirmLeaveGroup:!1}},watch:{confirmDeleteChat(e){this.showConfirm=e},confirmLeaveGroup(e){this.showConfirm=e}},created:function(){this.form=this.$store.state.chats.chat},unmounted(){this.isNew&&this.$store.dispatch("chats/fetchChats")},computed:{relations(){return this.$store.state.chats.relations}},methods:{handleInvite(){const e={chtNr:this.form.chtNr,email:this.email};this.$store.dispatch("chats/invite",e)},getImageUrl(e){return`public/image?name=${encodeURIComponent(e)}&t=${(new Date).getTime()}`},handleDeleteChat(){this.confirmDeleteChat=!0},handleLeaveGroup(){this.confirmLeaveGroup=!0},cancelConfirm(){this.confirmDeleteChat=!1,this.confirmLeaveGroup=!1},handleDelete(){this.confirmDeleteChat?this.$store.dispatch("chats/delete"):this.confirmLeaveGroup}}};var ke=s(4554),$e=s(4842),qe=s(6778),xe=s(151),Ze=s(5589),je=s(9367),Ne=s(677);const Qe=(0,w.Z)(Ce,[["render",he]]),We=Qe;C()(Ce,"components",{QPage:x.Z,QIcon:ke.Z,QInput:$e.Z,QList:N.Z,QBtn:j.Z,QDialog:qe.Z,QCard:xe.Z,QCardSection:Ze.Z,QAvatar:_.Z,QCardActions:je.Z}),C()(Ce,"directives",{ClosePopup:Ne.Z});const De={components:{ChatForm:We,ChatMessages:F,ChatList:W},data:function(){return{form:{chtNr:null,chtName:"",chat_relations:[],chat_messages:[]}}},methods:{async handleSave(){await this.$store.dispatch("chats/setChat",this.chat)},handleNew(){this.$store.dispatch("chats/set",{chat:{...this.form},edit:!0})}}};var Me=s(2652);const Ie=(0,w.Z)(De,[["render",o]]),ze=Ie;C()(De,"components",{QPageContainer:Me.Z})}}]);